import os
import subprocess

sources = ['factorial.d']

environment = Environment(
    tools=['dub', 'ldc', 'link'],
)
unit_threaded = environment.AddDubLibrary('unit-threaded', '0.7.32')
ut_main = environment.UnitThreadedMakeMain('ut_main.d', sources)

factorial_test = environment.ProgramAllAtOnce('factorial_test', sources + ut_main)
SideEffect('factorial_test.o', factorial_test)

Default(Command('test', factorial_test, './$SOURCE'))

Clean('.', ut_main)
